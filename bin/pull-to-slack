#!/usr/bin/env ruby
#
require 'slack-ruby-client'

class PullToSlack

  def initialize
    Slack.configure do |config|
      config.token = ENV['SLACK_API_TOKEN']
    end
  end

  def client
    @client ||= Slack::Web::Client.new
  end

  def send_message(channel, message)
    client.chat_postMessage(channel: "##{channel}", text: message, as_user: true)
  end

end

channel = ARGV[0]
message = ARGV[1]

pts = PullToSlack.new
pts.send_message(channel, message)
